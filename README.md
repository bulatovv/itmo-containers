# Лабораторная работа №1

## Примеры плохих и хороших практик
В репозитории приведены два докерфайла, `bad.Dockerfile` - использующий "плохие" практики Docker и `good.Dockerfile`, соответсвенно, их исправляющий.

Плохие практики связаны с:
1. Раздутием размера образа, что чревато:
  - Увеличением времени сборки/push/pull (медленный деплой)
  - Увеличенные траты ресурсов (пропускная способность, диск, процессорное время и RAM CI/CD пайплана)
  - Увеличением площади атаки
  Исправлено использованием:
  - multi-stage builds
  - cache mounts
  - .dockerignore  
  - не-установкой ненужных зависимостей (зависимости разработки, тестирования, рекомендованные зависимости apt)
  - использование урезанных образов

2. Использованием не-фиксированных версий, может вызвать
  - ошибки при ломающих обновлениях
  Исправлено использованием:
  - фиксированных версий

3. Плохая утилизация кэша (пр. не оптимальный порядок слоев)
 - Повторное выполнение тяжелых шагов при небольших изменениях кода, долгое выполнение ci/cd
 Исправлено использованием:
 - Более "тяжелые" и редкие к измениям слои находятся выше
 - cache mounts

Помимо этого, shell режим CMD заменен на exec для нормальной обработки сигналов

## Хорошие практики для python контейнеров
- Избегаем alpine образы (проблемы с отсутсвием собранных под alpine пакетов (wheels), увеличение времени сборки)
- Отключение записи байт-кода на диск
- Отключении буферизации вывода
- Использование poetry для более гибкого управления зависимостями
- Увеличен timeout обращений к pypi

## Когда НЕ использовать докер
- Графические приложения
- Если нужно взаимодействие с каким-то специфичным железом
  (проблемы с драйверами, для карт nvidia это решается их container toolkit, но у других вендоров этого может не быть)
